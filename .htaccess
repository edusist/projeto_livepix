<IfModule mod_rewrite.c>

    # Ativa o rewrite
    RewriteEngine On

    # Define o diretório base automaticamente
    RewriteBase /

    # Remove barra no final da URL (URL canonical)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.+)/$ /$1 [L,R=301]

    # Se o arquivo ou pasta não existir, envia para index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ index.php [QSA,L]

</IfModule>

# -------------------------------------------------------------
# SEGURANÇA
# -------------------------------------------------------------

# Bloqueia acesso direto às pastas internas
RedirectMatch 404 ^/(app|config|tests|vendor)/.*

# Impede listagem de diretórios
Options -Indexes

# -------------------------------------------------------------
# CACHE – melhora desempenho
# -------------------------------------------------------------
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/css "access plus 7 days"
    ExpiresByType application/javascript "access plus 7 days"
    ExpiresByType image/jpeg "access plus 30 days"
    ExpiresByType image/png "access plus 30 days"
    ExpiresByType image/webp "access plus 30 days"
    ExpiresByType image/svg+xml "access plus 30 days"
</IfModule>
